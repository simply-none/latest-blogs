# Moduleè¯­æ³•

## ModuleåŸºæœ¬è¯­æ³•

1. ESæ¨¡å—çš„è®¾è®¡æ€æƒ³ï¼šåœ¨ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥è¾“å‡ºå˜é‡ï¼ˆé™æ€åŒ–ï¼‰
   1. ç¼–è¯‘æ—¶åŠ è½½ï¼Œè‹¥ä»…ä½¿ç”¨importå¯¼å…¥ç‰¹å®šçš„æ–¹æ³•ï¼Œåˆ™åªåŠ è½½è¯¥æ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•ä¸åŠ è½½ï¼›
   2. ç”±äºESæ¨¡å—ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¼è‡´æ— æ³•å¼•ç”¨æ¨¡å—æœ¬èº«
   3. é™æ€åŠ è½½æ˜¯é™æ€åˆ†ææˆä¸ºå¯èƒ½ï¼Œæ¯”å¦‚ï¼šå®ã€ç±»å‹æ£€éªŒ
   4. importå’Œexportä¼šè¢«é™æ€åˆ†æï¼Œåªèƒ½å‡ºç°åœ¨æ¨¡å—çš„é¡¶å±‚ä½œç”¨åŸŸï¼Œæ¯•ç«Ÿåœ¨ç¼–è¯‘æ—¶ï¼Œä¸ä¼šå»æ‰§è¡Œå½¢å¦‚ifçš„ä»£ç 
   5. è€ŒCommonJSæ¨¡å—åœ¨è¿è¡Œæ—¶åŠ è½½æ•´ä¸ªæ¨¡å—å¯¹è±¡ï¼ˆåªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™æ‰èƒ½çŸ¥é“åŠ è½½çš„æ˜¯å“ªä¸ªæ¨¡å—ï¼Œå¯å®ç°é€‰æ‹©æ€§åŠ è½½ï¼‰ï¼Œç„¶ååœ¨è¯¥å¯¹è±¡ä¸Šè¯»å–éœ€è¦çš„æ–¹æ³•ï¼Œæ— æ³•åšåˆ°é™æ€ä¼˜åŒ–
2. ESæ¨¡å—å†…éƒ¨è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸€äº›ä¸¥æ ¼æ¨¡å¼çš„ç‰¹æ€§æœ‰ï¼šã€æœªå®Œæˆã€‘
3. exportå‘½ä»¤ï¼šåªæœ‰ç”¨è¯¥å‘½ä»¤å¯¼å‡ºçš„å˜é‡ï¼Œæ‰èƒ½å¤Ÿè¢«å¤–ç•Œæ‰€è¯»å–
   1. exportå¯¼å‡ºçš„æ¥å£ï¼Œä¸å€¼æ˜¯åŠ¨æ€ç»‘å®šçš„ï¼Œå¯å®æ—¶å–åˆ°æ¨¡å—å†…éƒ¨çš„å€¼ï¼›è€Œå…¶ä»–æ¨¡å—ï¼ˆæ¯”å¦‚CommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„ç¼“å­˜ï¼Œä¸å­˜åœ¨åŠ¨æ€æ›´æ–°ï¼‰
   2. exportå‘½ä»¤å¯ä»¥å‡ºç°åœ¨æ¨¡å—å†…éƒ¨çš„é¡¶å±‚ä»»ä½•ä½ç½®ï¼Œä½†æ˜¯ä¸èƒ½åœ¨æ¨¡å—å†…éƒ¨çš„å—ä½œç”¨åŸŸä¸­ï¼Œè¿™æ ·ä¼šæŠ¥é”™ï¼ˆä¹Ÿæ— æ³•åšé™æ€ä¼˜åŒ–ï¼‰
   3. æ¨¡å—çš„é»˜è®¤å¯¼å‡ºï¼š`export default xxx`ï¼Œå†™æ³•çœ‹ä»£ç 
      1. æœ¬è´¨ä¸Šæ˜¯å¯¼å‡ºä¸€ä¸ªå«åšdefaultçš„å˜é‡ï¼Œä¸”è¯¥å˜é‡åœ¨å¯¼å…¥æ—¶å¯å–ä»»æ„åå­—
      2. æœ¬è´¨ä¸Šæ˜¯å°†xxxèµ‹å€¼ç»™defaultå˜é‡ï¼Œæ‰€ä»¥xxxå¿…é¡»æ˜¯ä¸€ä¸ªå€¼ï¼ˆæ¯•ç«Ÿdefault = (var a = 1)æ˜¯ä¸åˆæ³•çš„ï¼‰
4. importå‘½ä»¤ï¼šåŠ è½½æ¨¡å—
   1. importæ¥å—ä¸€ä¸ªå¤§æ‹¬å·ï¼ŒæŒ‡å®šéœ€è¦å¯¼å…¥çš„æ¨¡å—æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¿…é¡»ä¸æ¨¡å—å¯¼å‡ºæ–¹æ³•åŒå
   2. importè¾“å…¥çš„å˜é‡æ˜¯åªè¯»çš„ï¼Œå³ä¸èƒ½å¤Ÿä¿®æ”¹è¯¥å˜é‡ï¼ˆè¯¥å˜é‡çš„å†…å­˜åœ°å€ä¸å…è®¸å‘ç”Ÿå˜é‡ï¼Œå˜é‡å±æ€§è¿˜æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼‰
   3. import...fromåé¢çš„è·¯å¾„ï¼Œå¯ä¸ºç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä¸ºç»å¯¹è·¯å¾„ï¼Œè‹¥ä»…æœ‰æ¨¡å—åï¼Œåˆ™å¿…é¡»æœ‰é…ç½®æ–‡ä»¶ï¼Œè®©JSå¼•æ“çŸ¥æ™“æ¨¡å—çš„ä½ç½®
   4. importå‘½ä»¤æœ‰æå‡æ•ˆæœï¼Œä¼šæç¤ºåˆ°æ•´ä¸ªæ¨¡å—çš„å¤´éƒ¨ï¼Œæœ€å…ˆæ‰§è¡Œ
   5. importæ˜¯ç¼–è¯‘æ—¶æ‰§è¡Œçš„ï¼Œæ‰€ä»¥åœ¨importè¯­å¥ä¸­ä¸å…è®¸å‡ºç°è¡¨è¾¾å¼å’Œå˜é‡ï¼ˆè¿™äº›éƒ½æ˜¯è¿è¡Œæ—¶æ‰§è¡Œï¼‰
   6. importå¯æ‰§è¡Œå¯¼å…¥çš„æ•´ä¸ªæ¨¡å—ï¼Œæ¯”å¦‚`import './a.js'`ï¼Œæ­¤æ—¶a.jsæ¨¡å—è¢«æ‰§è¡Œï¼Œå¤šæ¬¡å¯¼å…¥ä»…æ‰§è¡Œä¸€æ¬¡ï¼ˆimportè¯­å¥æ˜¯å•ä¾‹æ¨¡å¼ï¼‰
   7. åŠ è½½è¯¥æ¨¡å—çš„æ‰€æœ‰å˜é‡ï¼š`import * as all from './a.js'`ï¼Œå³ç”¨*å·æŒ‡å®šä¸€ä¸ªåˆ«åï¼Œè¿™é‡Œä¹ŸåŒ…æ‹¬äº†defaultå˜é‡
   8. æ¨¡å—çš„é»˜è®¤å¯¼å…¥ï¼Œå³å¯¼å…¥defaultå˜é‡ï¼š`import xxx from './a.js'`ï¼Œå…¶ä¸­xxxå¯å–ä»»æ„å€¼
   9. é»˜è®¤å¯¼å…¥å¯ä¸å…¶ä»–å¯¼å…¥æ··åˆä½¿ç”¨ï¼š`import xxx, { a, b } from './a.js'`
5.  exportå’Œimportæ··åˆä½¿ç”¨ï¼šå®é™…ä¸Šå½“å‰æ¨¡å—æœªå¯¼å…¥è¯¥æ¥å£ï¼Œå³åˆ»å¯¹å¤–è½¬å‘å¯¼å…¥çš„æ¥å£ï¼Œä½†æ˜¯å½“å‰æ¨¡å—ä¸èƒ½ä½¿ç”¨è¯¥æ¥å£
    1.  æ¨¡å—çš„ç»§æ‰¿ï¼šè¯´åˆ°åº•å°±æ˜¯ä½¿ç”¨æ··åˆè¯­æ³•
    2.  è·¨å¸¸é‡æ¨¡å—ï¼ˆå¸¸é‡å…±äº«ï¼‰ï¼šä¹Ÿæ˜¯ä½¿ç”¨æ··åˆè¯­æ³•
6. import()å‡½æ•°ï¼šåœ¨ES2020ä¸­å¼•å…¥ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½æ¨¡å—
   1. importæ¥å—çš„å‚æ•°ï¼Œåœ¨import()å‡½æ•°ä¸­å‡èƒ½å¤Ÿæ¥å—
   2. è¯¥å‡½æ•°è¿”å›Promiseå¯¹è±¡ï¼Œä¸ºå¼‚æ­¥åŠ è½½ï¼Œä¸”thençš„å‚æ•°ä¸ºæ•´ä¸ªæ¨¡å—å¯¹è±¡ï¼Œç±»ä¼¼äºåŠ è½½æ‰€æœ‰å˜é‡(4.7)
   3. è¯¥å‡½æ•°å¯ç”¨äºä»»ä½•åœ°æ–¹
   4. é€‚ç”¨åœºæ™¯ï¼š
      1. æŒ‰éœ€åŠ è½½ï¼Œæ¯”å¦‚ç›‘å¬äº‹ä»¶ååŠ è½½
      2. æ¡ä»¶åŠ è½½ï¼Œæ ¹æ®ä¸åŒæƒ…å†µï¼ŒåŠ è½½ä¸åŒæ¨¡å—
      3. åŠ¨æ€æ¨¡å—è·¯å¾„ï¼Œå†…éƒ¨å¯è¿è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°çš„è¿”å›å€¼ä¸ºåŠ è½½çš„è·¯å¾„


```js
// exportçš„å†™æ³•ï¼š

// å†™æ³•ä¸€ï¼šå£°æ˜è¯­å¥å‰åŠ ä¸Šexport
export var a = 1
export function b () {}

// å†™æ³•äºŒï¼šå…ˆå£°æ˜ï¼Œç„¶åå°†å˜é‡(åŒ…æ‹¬å‡½æ•°ã€ç±»ç­‰ç­‰ï¼‰èµ‹ç»™exportä¸­
var a = 1
function b () {}
export {
  a,
  b
}

// å†™æ³•ä¸‰ï¼šå¯é‡å‘½åï¼Œä¸”å¯é‡å‘½åå¤šæ¬¡
export {
  a as aa,
  a as aaa,
  b as bb,
  b as bbb
}

// å†™æ³•å››ï¼šé»˜è®¤å¯¼å‡ºï¼Œä¸èƒ½ç›´æ¥å¯¼å‡ºå˜é‡å£°æ˜ï¼Œå¯ç”¨äºclasså’Œfunctionç­‰æ­£å¸¸çš„å€¼
export default function () {}

// å³ç­‰äºï¼š
default = function () {}

// æ‰€ä»¥ï¼šä¸‹é¢çš„æ˜¯é”™è¯¯çš„
export default var a = 9

// ç­‰äºï¼šæ˜¾ç„¶æ˜¯é”™è¯¯çš„
default = (var a = 9)

// å†™æ³•äº”ï¼šé»˜è®¤è¾“å‡ºå˜é‡ï¼ˆæ¯”4é è°±ï¼‰
var a = 1
export default a

// importå†™æ³•ï¼š

// å†™æ³•ä¸€ï¼šä½¿ç”¨å¤§æ‹¬å·ï¼š
import { a, b } from './a.js'

// å†™æ³•äºŒï¼šä½¿ç”¨å¤§æ‹¬å·ï¼Œå¹¶èµ·åˆ«åï¼š
import { a as aaa, b} from './a.js'

// å†™æ³•ä¸‰ï¼šè·¯å¾„:çº¯æ¨¡å—åå¿…é¡»æœ‰é…ç½®æ–‡ä»¶
import { a, b } from 'a'

// å†™æ³•å››ï¼šå¯¼å…¥çš„æ•´ä¸ªæ¨¡å—è¢«æ‰§è¡Œ
import './a.js'

// å†™æ³•äº”ï¼šå¯¼å…¥default
import defa from './a.js'

// å†™æ³•å…­ï¼šæ··åˆå¯¼å…¥
import defa, { a, b } from './a.js'

// å¯¼å…¥å¯¼å‡ºæ··åˆå†™æ³•ï¼šç›¸å½“äºä¸­è½¬ç«™

// å†™æ³•ä¸€ï¼š
export { a, b } from './a.js'

// å†™æ³•äºŒï¼šæ¥å£æ”¹å
export { a as aaa , b as bbb } from './a.js'

// å†™æ³•ä¸‰ï¼šä¸­è½¬æ‰€æœ‰
export * from './a.js'

// å†™æ³•å››ï¼šä¸­è½¬æ‰€æœ‰å¹¶é‡å‘½åï¼ˆES2020ä¹‹åæ‰æœ‰çš„ï¼‰
export * as all from './a.js'

// æ¨¡å—çš„æ¥å£æ”¹åï¼ˆå…·åè½¬é»˜è®¤ï¼‰
export { a as default } from './a.js'

// æ¨¡å—çš„æ¥å£æ”¹åï¼ˆé»˜è®¤è½¬å…·åï¼‰
export { default as a } from './a.js'

// import() å‡½æ•°ï¼š
import('./a.js').then(all => {
  console.log(all)
})

// åŒæ—¶åŠ è½½å¤šä¸ªæ¨¡å—ï¼š
Promise.all([
  import('./a.js'),
  import('./b.js'),
  import('./c.js')
]).then(([ma, mb, mc]) => {
  console.log(aAll, bAll, cAll)
})
```

## æ³¨æ„äº‹é¡¹

1. ä¼ ç»Ÿæ–¹æ³•ä¸­ï¼Œæµè§ˆå™¨é€šè¿‡scriptæ ‡ç­¾åŠ è½½è„šæœ¬ï¼Œé»˜è®¤ä¸ºåŠ è½½JavaScriptï¼ˆå³å¯çœç•¥typeå±æ€§ï¼‰
2. é»˜è®¤æƒ…å†µä¸‹ï¼ŒJavaScriptå¼•æ“æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œé‡åˆ°scriptæ ‡ç­¾ï¼Œé¦–å…ˆä¸‹è½½è„šæœ¬ï¼Œç„¶åæ‰§è¡Œè„šæœ¬ï¼Œæœ€åæ‰ä¼šç»§ç»­æ‰§è¡Œå…¶ä»–å†…å®¹ï¼Œæ•…è€Œï¼Œå¼‚æ­¥æ–¹æ³•æœ‰ï¼š
   1. ä½¿ç”¨deferå±æ€§ï¼šæ•´ä¸ªé¡µé¢åœ¨å†…å­˜ä¸­æ­£å¸¸æ¸²æŸ“ç»“æŸï¼Œæ‰ä¼šæ‰§è¡Œè¯¥è„šæœ¬ï¼ˆå¤šä¸ªè„šæœ¬æŒ‰å‡ºç°é¡ºåºåŠ è½½ï¼‰
   2. ä½¿ç”¨asyncå±æ€§ï¼šè„šæœ¬ä¸‹è½½å®Œæˆï¼Œå¼•æ“å°±ä¼šåœæ­¢æ¸²æŸ“å…¶ä»–å†…å®¹ï¼Œç„¶åæ‰§è¡Œè¯¥è„šæœ¬ï¼ˆå¼‚æ­¥åŠ è½½ï¼Œä¸æŒ‰é¡ºåºï¼‰
3. ES6æ¨¡å—ï¼šåœ¨scriptæ ‡ç­¾ä¸­ï¼Œtypeå±æ€§å€¼ä¸ºmoduleï¼Œè¯¥æ¨¡å—æ˜¯å¼‚æ­¥åŠ è½½ï¼Œç­‰åŒäºåŠ ä¸Šäº†deferå±æ€§
   1. å¯åŠ ä¸Šasyncå±æ€§
4. å¯¹äºå¤–éƒ¨çš„æ¨¡å—è„šæœ¬ï¼Œå³å•ç‹¬çš„jsæ–‡ä»¶ï¼Œéœ€æ³¨æ„ï¼š
   1. ä»£ç æ˜¯åœ¨æ¨¡å—å†…éƒ¨è¿è¡Œçš„ï¼Œéå…¨å±€ä½œç”¨åŸŸè¿è¡Œï¼Œé¡¶å±‚å˜é‡ï¼Œå¤–éƒ¨ä¸å¯è§
   2. è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼
   3. å¯ä½¿ç”¨importå¯¼å…¥å…¶ä»–æ¨¡å—ï¼Œä½†å¿…é¡»åŠ ä¸Šæ¨¡å—æ–‡ä»¶çš„åç¼€å
   4. åŒä¸€ä¸ªæ¨¡å—å¤šæ¬¡å¯¼å…¥ï¼Œåªæ‰§è¡Œä¸€æ¬¡
   5. æ¨¡å—ä¸­ï¼Œé¡¶å±‚thisè¿”å›undefinedï¼Œè€Œéwindowï¼›å¯åˆ©ç”¨è¯¥ç‰¹æ€§ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºES6æ¨¡å—`const isNotES6 = this !== undefined`

## ES6æ¨¡å—ä¸CommonJSæ¨¡å—çš„å·®å¼‚

1. CommonJSæ¨¡å—:
   1. è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼Œå³å½“è¯¥å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¤–éƒ¨è¯»å–ä»ç„¶æ˜¯ä¸å˜çš„ï¼Œé™¤éå¯¼å‡ºä¸€ä¸ªå–å€¼å‡½æ•°ï¼Œæ¯”å¦‚`get counter () { return counter }`
   2. è¿è¡Œæ—¶åŠ è½½
   3. requireæ˜¯åŒæ­¥åŠ è½½
   4. ä½¿ç”¨require()å’Œmodule.exports
2. ESæ¨¡å—ï¼š
   1. è¾“å‡ºçš„æ˜¯å€¼çš„åªè¯»å¼•ç”¨ï¼Œå½“åŸå§‹å€¼å˜äº†ï¼Œé€šè¿‡importåŠ è½½çš„è¯¥å€¼ä¹Ÿä¼šåŒæ—¶å‘ç”Ÿå˜åŒ–ï¼›ä¸”å¯¹è¯¥å€¼è¿›è¡Œèµ‹å€¼ä¼šå‘ç”Ÿé”™è¯¯
   2. ç¼–è¯‘æ—¶åŠ è½½
   3. importæ˜¯å¼‚æ­¥åŠ è½½ï¼Œæœ‰ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¾èµ–è§£æé˜¶æ®µ
   4. exportå¯¼å‡ºçš„æ¥å£ï¼Œè¢«ä¸åŒçš„æ¨¡å—å¯¼å…¥ï¼Œå¼•ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Œå¦‚æœæŸæ¨¡å—æ”¹å˜äº†æŸå€¼ï¼Œè¯¥å€¼åœ¨å¦ä¸€ä¸ªæ¨¡å—ä¸­ä¹Ÿè·Ÿç€æ”¹å˜
   5. ä½¿ç”¨importå’Œexport
   6. æ¨¡å—çš„åŠ è½½è·¯å¾„ï¼ˆimportå‘½ä»¤å’Œpackage.jsonä¸­çš„mainå­—æ®µï¼‰å¿…é¡»ç»™å‡ºè„šæœ¬çš„å®Œæ•´è·¯å¾„ï¼ˆä¸èƒ½çœç•¥åç¼€åï¼‰
   7. nodejsçš„mjsæ–‡ä»¶æ”¯æŒurlè·¯å¾„ï¼Œå³ç»™è·¯å¾„å¸¦ä¸Šå‚æ•°ï¼ˆåŠ ä¸Šä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼šæ¯”å¦‚`:`,`#`,`?`,`%`ï¼‰ï¼Œè¿™æ ·è¯¥è„šæœ¬å¯¼å…¥å¤šæ¬¡ï¼Œå°±èƒ½å¤Ÿè¿è¡Œå¤šæ¬¡äº†ï¼›è‹¥ä»¥è‹¥æƒ³è„šæœ¬ä»…è¿è¡Œä¸€æ¬¡ï¼Œå¿…é¡»å¯¹ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬ä¹‰
3. CommonJSæ¨¡å—ä¸ES6æ¨¡å—äº’ä¸å…¼å®¹

## Node.jsçš„æ¨¡å—åŠ è½½æ–¹æ³•

1. v13.2å¼€å§‹ï¼ŒNodeé»˜è®¤æ‰“å¼€äº†å¯¹ES6æ¨¡å—çš„æ”¯æŒ
2. Node.jsè¦æ±‚ES6æ¨¡å—å¿…é¡»é‡‡ç”¨`mjs`ä¸ºåç¼€åï¼š
   1. åªè¦è„šæœ¬ä¸­é‡‡ç”¨äº†exportå’Œimportï¼Œåˆ™å¿…é¡»ä½¿ç”¨`mjs`ä¸ºåç¼€å
   2. Node.jsé‡åˆ°`mjs`åç¼€æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºes6æ¨¡å—
   3. ä¸é‡‡ç”¨mjsåç¼€ï¼Œå¿…é¡»åœ¨package.jsonä¸­æŒ‡å®štypeå­—æ®µä¸ºmodule/commonjs(é»˜è®¤)
   4. ä¸¤ä¸ªæ¨¡å—ä¹‹é—´ä¸èƒ½æ··ç”¨ï¼Œåªç”¨importæ‰èƒ½åŠ è½½mjsæ–‡ä»¶ï¼ˆrequireä¸èƒ½ï¼‰ï¼Œmjsæ–‡ä»¶åªèƒ½ä½¿ç”¨importå‘½ä»¤
3. `package.json`ï¼šï¼ˆæ„Ÿè§‰æ˜¯é¡¹ç›®æ‰“åŒ…æ—¶ä½¿ç”¨çš„ï¼‰
   1. mainå­—æ®µï¼šæŒ‡å®šæ¨¡å—åŠ è½½çš„å…¥å£æ–‡ä»¶
   2. exportså­—æ®µï¼šä¼˜å…ˆçº§é«˜äºmainå­—æ®µï¼Œå¯ä»¥ç”¨æ¥ï¼š
      1. è‹¥exportså¯¹è±¡ä¸­çš„keyä¸ºä¸€ç‚¹ï¼Œåˆ™ä¼˜å…ˆçº§é«˜äºmainå­—æ®µï¼Œä»£è¡¨æ¨¡å—çš„ä¸»å…¥å£ï¼š`'.': './main.js'`ï¼Œå¹¶å¯ç›´æ¥ç®€å†™ä¸ºï¼š`exports: './main.js'`
      2. ç»™æ–‡ä»¶èµ·åˆ«åï¼š`'./submodule': './src/submodule.js`ï¼Œä¾‹å¦‚`import sub from 'es-module-package/submodule`ç­‰äºå¯¼å…¥`./node_modules/es-module-package/src/submodule.js`
      3. ç»™ç›®å½•èµ·åˆ«åï¼š`'./folder/': './src/folder/`ï¼Œç”¨æ³•å’Œ1ç±»ä¼¼
      4. æœªæŒ‡å®šåˆ«åï¼Œåˆ™ä¸èƒ½ä½¿ç”¨æ¨¡å—å+è„šæœ¬åå¯¼å…¥æ–‡ä»¶
      5. ç”±äºesæ¨¡å—æ˜¯æ–°ç‰ˆæœ¬çš„nodeæ”¯æŒçš„ï¼Œæ‰€ä»¥ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬ï¼Œå¯åŒæ—¶ä½¿ç”¨mainå’Œexportså­—æ®µ
      6. æ¡ä»¶åŠ è½½ï¼Œä¸ºes6æ¨¡å—å’Œcommonjsæ¨¡å—æŒ‡å®šä¸åŒçš„å…¥å£ï¼Œå¿…é¡»æ‰“å¼€`--experimental-conditional-exports`æ ‡å¿—ğŸ‡
4. commonjsæ¨¡å—åŠ è½½es6æ¨¡å—ï¼šä½¿ç”¨async...awaitå’Œimport()ğŸ¥£
5. es6æ¨¡å—åŠ è½½commonjsæ¨¡å—ï¼šåªèƒ½ä½¿ç”¨importæ•´ä½“åŠ è½½ğŸ¥¦:
   1. å˜é€šæ–¹æ³•ï¼šä½¿ç”¨`module.createRequire()`(ä¸å»ºè®®ä½¿ç”¨)
6. åŒæ—¶æ”¯æŒä¸¤ç§æ¨¡å—çš„æ–¹æ³•ï¼šã€æœªæ‰§è¡Œã€‘
7. Nodejsçš„å†…ç½®æ¨¡å—ï¼š
   1. å†…ç½®æ¨¡å—å¯ä»¥æ•´ä½“åŠ è½½ï¼šimport EventEmitter from 'events'
   2. å†…ç½®æ¨¡å—å¯ä»¥å±€éƒ¨åŠ è½½ï¼šimport { readFile } from 'fs'
8. Nodejsçš„importå‘½ä»¤ä»…èƒ½åŠ è½½æœ¬åœ°æ¨¡å—ï¼ˆfileåè®®å’Œdataåè®®ï¼‰ï¼Œä¸èƒ½åŠ è½½è¿œç¨‹æ¨¡å—ï¼Œå¹¶ä¸”è„šæœ¬è·¯å¾„åªæ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œä¸æ”¯æŒç»å¯¹è·¯å¾„
9. es6æ¨¡å—æ˜¯é€šç”¨çš„ï¼Œå³åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç¯å¢ƒçš„æ•ˆæœä¸€è‡´ï¼Œæ‰€ä»¥esæ¨¡å—ä¸èƒ½ä½¿ç”¨commonjsæ¨¡å—çš„ä¸€äº›ç‰¹ä¿—å˜é‡,ä¸‹é¢çš„é¡¶å±‚å˜é‡åœ¨esæ¨¡å—ä¸­ä¸å­˜åœ¨ï¼š
   1.  é¡¶å±‚thisï¼šes6æ¨¡å—æŒ‡å‘undefinedï¼Œcommonjsæ¨¡å—æŒ‡å‘å½“å‰æ¨¡å—
   2.  arguments
   3.  require
   4.  module
   5.  exports
   6.  __dirname
   7.  __filename

```js
// ğŸ‡ï¼šæ¡ä»¶åŠ è½½
{
   'type': 'module',
   'exports': {
      '.': {
         // æŒ‡å®šcommonjsçš„å…¥å£
         'require': './main.cjs',
         // æŒ‡å®šå…¶ä»–æ¨¡å—çš„å…¥å£
         'default': './main.js'
      },
      // å…¶ä»–åˆ«å
      './feature': './src/feature.js'
   }
}

// ğŸ¥£ï¼šcommonjsæ¨¡å—åŠ è½½es6æ¨¡å—
(async () => {
   await import('./src/...')
})()

// ğŸ¥¦ï¼šes6æ¨¡å—åŠ è½½commonjsæ¨¡å—ï¼š
import packageMain from 'commonjs-package'
const { main } = packageMain

// ä¸èƒ½ä½¿ç”¨ï¼š
import { main } from 'commonjs-package'

// å˜é€šæ–¹æ³•ï¼š(ä¸å»ºè®®ä½¿ç”¨)
// a.cjs
module.exports = 'packageMain'

// b.mjs
import { createRequire } from 'module'
const require = createRequire(import.meta.url)
const packageMain = require('commonjs-package')

packageMain === 'packageMain' // true

```

## å¾ªç¯åŠ è½½ã€æœªå®Œæˆã€‘